<ROSETTASCRIPTS>
 
    <TASKOPERATIONS>

         <RestrictAbsentCanonicalAAS name=ala_only resnum=0 keep_aas="A" />

         <IncludeCurrent name=current/>
         <LimitAromaChi2 name=arochi />
         <ExtraRotamersGeneric name=ex1_ex2 ex1=1 ex2=1/>
         <ReadResfile name="resfile"/>


    </TASKOPERATIONS>

  <SCOREFXNS>
    <memb_hires weights=mpframework_smooth_fa_2012 />

    <hard_bb weights=talaris2014.wts >
      <Reweight scoretype=coordinate_constraint weight=2. />
      <Reweight scoretype=cart_bonded weight = 0.5 />
      <Reweight scoretype=pro_close weight=0.0/>
    </hard_bb>

  </SCOREFXNS>

    <FILTERS>

    <PackStat name=packstat threshold=0.4 confidence=0/>
    <ScoreType name=score_eval scorefxn=memb_hires threshold=1000/>

  </FILTERS>
 
  <MOVERS>

    <PackRotamersMover name=transform_sc scorefxn=hard_bb task_operations=ala_only/>

    <ConstraintSetMover name="add_cst" cst_file="%%cst_file%%"/>
    <MinMover name=hardmin_bb scorefxn=hard_bb type=lbfgs_armijo_nonmonotone tolerance=0.001 chi=0 bb=1 bondangle=1 bondlength=1 jump=all cartesian=1 max_iter=1000 />
    <ClearConstraintsMover name=clearconstraints/>

    <AddMembraneMover name=add_memb/>
    <MembranePositionFromTopologyMover name=init_pos/>
    <PackRotamersMover name=buildSC scorefxn=memb_hires task_operations=resfile,arochi,ex1_ex2/>
    <FastRelax name=fast_relax scorefxn=memb_hires repeats=8 task_operations=resfile,current,arochi,ex1_ex2/>

    <Backrub name=bRub />

  </MOVERS>
 
  <PROTOCOLS>

      <Add mover=buildSC/>
      <Add mover=add_cst/>
      <Add mover=hardmin_bb/>
      <Add mover=clearconstraints/>

      <Add mover=add_memb/>
      <Add mover=init_pos/>

    <Add mover=buildSC/>
    <Add mover=fast_relax/>

    <Add mover=fast_relax/>

    <Add filter=packstat/>
    <Add filter=score_eval/>

  </PROTOCOLS>

  <OUTPUT scorefxn=memb_hires />

</ROSETTASCRIPTS>